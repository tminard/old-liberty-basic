{\rtf1\ansi\ansicpg1252\uc1 \deff0\deflang1033\deflangfe1033{\fonttbl{\f0\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f2\fmodern\fcharset0\fprq1{\*\panose 02070309020205020404}Courier New;}
{\f4\froman\fcharset0\fprq2{\*\panose 00000000000000000000}Times{\*\falt Times New Roman};}{\f272\froman\fcharset238\fprq2 Times New Roman CE;}{\f273\froman\fcharset204\fprq2 Times New Roman Cyr;}{\f275\froman\fcharset161\fprq2 Times New Roman Greek;}
{\f276\froman\fcharset162\fprq2 Times New Roman Tur;}{\f277\froman\fcharset186\fprq2 Times New Roman Baltic;}{\f284\fmodern\fcharset238\fprq1 Courier New CE;}{\f285\fmodern\fcharset204\fprq1 Courier New Cyr;}
{\f287\fmodern\fcharset161\fprq1 Courier New Greek;}{\f288\fmodern\fcharset162\fprq1 Courier New Tur;}{\f289\fmodern\fcharset186\fprq1 Courier New Baltic;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;
\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;
\red192\green192\blue192;}{\stylesheet{\widctlpar\adjustright \fs20\cgrid \snext0 Normal;}{\s1\keepn\widctlpar\adjustright \b\fs28\ul \sbasedon0 \snext0 heading 1;}{\*\cs10 \additive Default Paragraph Font;}{\*\cs15 \additive \ul\cf2 \sbasedon10 
Hyperlink;}}{\info{\title Documentation for the PlayMIDI32 dll}{\author Brad Moore}{\operator Brad Moore}{\creatim\yr2003\mo3\dy1\hr23\min9}{\revtim\yr2003\mo3\dy1\hr23\min9}{\version2}{\edmins0}{\nofpages3}{\nofwords1022}{\nofchars5826}
{\*\company Weyerhaeuser}{\nofcharsws7154}{\vern113}}\widowctrl\ftnbj\aenddoc\formshade\viewkind1\viewscale114\viewzk2\pgbrdrhead\pgbrdrfoot \fet0\sectd \linex0\sectdefaultcl {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2
\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6
\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang
{\pntxtb (}{\pntxta )}}\pard\plain \s1\keepn\widctlpar\outlinelevel0\adjustright \b\fs28\ul {Documentation for the PlayMPEG32 dll
\par }\pard\plain \widctlpar\adjustright \fs20\cgrid {\cgrid0 
\par }{\b\fs24\cgrid0 DLL Information:
\par }{\cgrid0 
\par PlayMPEG32.dll
\par Copyright (c) 2002, 2003 by Brad Moore
\par version 1.0 - An MP3 Background player DLL, based on PlayMIDI32, also by Brad Moore, March 1, 2003
\par 
\par }{\b\fs24\cgrid0 DLL Description:
\par }{\cgrid0 
\par The PlayMPEG32.dll is a libr
ary function (i.e. a dll) for playing MPEG audio (MP3) files in a continual loop in the background of the system.  This dll is designed to be used with Liberty Basic version 3 and up.  It should be callable by any language that supports calling external 3
2 bit library functions.   This is a 32 bit dll.  There is no16 bit counterpart to this dll.
\par 
\par For those interested in Liberty Basic - please check them out on the web at }{\field{\*\fldinst {\cgrid0  HYPERLINK http://www.libertybasic.com }{\cgrid0 {\*\datafield 
00d0c9ea79f9bace118c8200aa004ba90b02000000170000001c00000068007400740070003a002f002f007700770077002e006c00690062006500720074007900620061007300690063002e0063006f006d000000e0c9ea79f9bace118c8200aa004ba90b3a00000068007400740070003a002f002f007700770077002e00
6c00690062006500720074007900620061007300690063002e0063006f006d002f000000}}}{\fldrslt {\cs15\ul\cf2 http://www.libertybasic.com}}}{\cgrid0 
\par  - The dll was written in PowerBasic/DLL v6.0.  For information about PowerBasic check them out on the web at }{\field{\*\fldinst {\cgrid0  HYPERLINK http://www.powerbasic.com }{\cgrid0 {\*\datafield 
00d0c9ea79f9bace118c8200aa004ba90b02000000170000001a00000068007400740070003a002f002f007700770077002e0070006f00770065007200620061007300690063002e0063006f006d000000e0c9ea79f9bace118c8200aa004ba90b3600000068007400740070003a002f002f007700770077002e0070006f00
770065007200620061007300690063002e0063006f006d002f000000}}}{\fldrslt {\cs15\ul\cf2 http://www.powerbasic.com}}}{\cgrid0  
\par 
\par 
\par }{\b\fs24\cgrid0 Using the DLL:
\par }{\cgrid0 
\par This dll has one function:
\par 
\par }{\f2\fs22\cgrid0 \tab PlayMPEG (Filename as string) Result as Long
\par }{\cgrid0 
\par Parameters :
\par 
\par }\pard \li720\widctlpar\tx1620\adjustright {\cgrid0 Filename : A string containing the name of MPEG (MP3) file to play.   
\par \tab The string must be Null Terminated.
\par }\pard \widctlpar\tx1620\adjustright {\cgrid0 
\par }\pard \li720\widctlpar\tx1620\adjustright {\cgrid0  Result :   \tab A long integer value that specifies success or error conditions.
\par }\pard \widctlpar\tx1620\adjustright {\cgrid0 
\par \tab -1 = Successful closure of thread
\par \tab 0 = Success
\par \tab 1 = Unsupported File Type\tab \tab 
\par \tab 2 = File not found
\par \tab 3 = Failure to start thread
\par  \tab 4 = DLL Called without filename - no MPEG thread playing
\par              \tab 5 = Function Not Implemented
\par }\pard \widctlpar\adjustright {\cgrid0 
\par 
\par }{\b\fs24\cgrid0 Notes about the function:
\par }{\cgrid0 
\par To use the function pass it a filename in the form of a null terminated string.  In Liberty Basic do this by appending a chr$(0) to the end of a string value.
\par 
\par }\pard \li720\widctlpar\adjustright {\f2\fs22\cgrid0 Fname$ = \ldblquote mysong.mp3\rdblquote  + chr$(0)
\par }\pard \widctlpar\adjustright {\cgrid0 
\par The filename can be fully qualified or just a simple filename.  The current working directory is assumed if          
    the fully qualified filename is not passed.  The dll will verify the existence of the file specified before attempting to stream the music.  If the file does not exist the dll will return an error value (2 - File not found).  
\par 
\par The function only suppor
ts the playing of MPEG audio (MP3) files.  Unlike the PlayMIDI32 dll, this dll plays actual music files.  The dll does not decode the compresses music files (MP3 files), but rather relies on the basic Windows multimedia subsystem to decode and play the MP
E
G audio (MP3) file.  The dll requires at least Windows 95 and a PC system sound device capable of playing MPEG audio (MP3) files.  The dll will not determine whether the host system can or can not play the music.  (I have never tested this on a PC that do
e
s not support MPEG audio decoding, so I unsure what will happen in this case.)  Also, the dll will insure the music file passed is of type MP3 based on the file extension, but it does not inspect the content of the file to determine whether it is a valid 
MPEG audio file.  
\par 
\par The MP3 music is played in a loop continuously until instructed to quit.  Telling the dll to quite playing music is done by simply passing a null as  the filename.  Also - if you have an MPEG audio (MP3) file playing in the background (u
sing this DLL) and you prematurely halt the program that called the dll (such as Liberty Basic running some source code of yours) \endash  it will cause a GPF!  You\rquote re program will crash!  To avert this \endash 
 always stop the music from playing before terminating your program.
\par 
\par See the sample Liberty Basic program that comes with the dll for a better understanding of how to use the dll.  It is called TESTMPEG.BAS and it is a Liberty Basic 3 program.
\par 
\par 
\par }{\b\fs24\cgrid0 How it works:
\par }{\cgrid0 
\par The PlayMPEG32 dll is very simple.  It gets a filenam
e from the calling program.  It verifies the files existance and then it creates a threaded process that runs under the dll, but separate from the dll.  This process issues a few commands through the Windows Multimedia DLL interface and begins the playbac
k of the MPEG audio (MP3) music file.  Every 10}{\super\cgrid0 th}{\cgrid0 
 of a second the process checks on the progress of the song.  If it has arrived at the end of the song it simply issues a command to begin playing the song again from the starting position.  This repeats unti
l the thread gets a signal to end, at which time playback is halted and the thread is self terminated.  
\par 
\par }{\b\fs24\cgrid0 About the music:
\par }{\cgrid0 
\par The sample music file provided was obtained from }{\field{\*\fldinst {\cgrid0  HYPERLINK http://www.cipoo.net/music_e.html }{\cgrid0 {\*\datafield 
00d0c9ea79f9bace118c8200aa004ba90b02000000170000002200000068007400740070003a002f002f007700770077002e006300690070006f006f002e006e00650074002f006d0075007300690063005f0065002e00680074006d006c000000e0c9ea79f9bace118c8200aa004ba90b4400000068007400740070003a00
2f002f007700770077002e006300690070006f006f002e006e00650074002f006d0075007300690063005f0065002e00680074006d006c000000}}}{\fldrslt {\cs15\ul\cf2 http://www.cipoo.net/music_e.html}}}{\cgrid0  \endash 
 it is a publicly distributed recording of choral music in MP3 format.  The music is a score called }{\f4\ul Ce moys de May}{\f4  }{written by }{\b\f4 Janequin Clement,}{
 and it is in the public domain.  If you like the music, please visit the site and check out more of their offereings.}{\cgrid0 
\par 
\par }{\b\fs24\cgrid0 Getting Help:
\par }{\cgrid0 
\par If you have questions, please check out my website for information on how to get a hold of me.  The URL is }{\field{\*\fldinst {\cgrid0  HYPERLINK http://www.freewebz.com/lb-connection }{\cgrid0 {\*\datafield 
00d0c9ea79f9bace118c8200aa004ba90b02000000170000002600000068007400740070003a002f002f007700770077002e0066007200650065007700650062007a002e0063006f006d002f006c0062002d0063006f006e006e0065006300740069006f006e000000e0c9ea79f9bace118c8200aa004ba90b4c0000006800
7400740070003a002f002f007700770077002e0066007200650065007700650062007a002e0063006f006d002f006c0062002d0063006f006e006e0065006300740069006f006e000000}}}{\fldrslt {\cs15\ul\cf2 http://www.freewebz.com/lb-connection}}}{\cgrid0 
\par 
\par }{\b\fs24\cgrid0 LICENSE 
\par }{
\par Brad Moore hereby gives you a non-exclusive license to use the software PlayMPEG32 (the Software). 
\par This license is for unlimited use and includes the limited right of re-distribute of the software without requiring royalty, notification or even crediting of Brad Moore.  The software is intended to be integrated into a larger work.
\par 
\par You may: 
\par - re-distribute just the DLL in the context of a larger unique and original work of your own;
\par - use the Software on any number of computers you own;
\par - copy the Software for archival purposes, provided any copy contains all of the original Software's proprietary notices. 
\par 
\par You may not: 
\par - re-distribute this entire package on your own website, upload to other websites or online archives, package it into a CD ROM or other archive or in any manner sell the complete package; 
\par - modify, translate, reverse engineer, decompile, disassemble (except to the extent applicable laws specifically prohibit such restriction), 
\par - rent, lease, transfer or otherwise transfer rights to the Software except as permitted above; 
\par - remove any proprietary notices or labels on the Software. 
\par 
\par TERMINATION. 
\par The license will terminate automatically if you fail to comply with the limitations described above. On termination, you must destroy all copies of the Software and Documentation. 
\par 
\par DISCLAIMER OF WARRANTY 
\par --------------------------------------------- 
\par The Software is provided on an AS IS basis, without warranty of any kind, including without limitation the warranties of merchantability, fitness for a particular purpose and non-infringement. 
\par The entire risk as to the quality and performance of the Software is borne by you. 
\par Should the Software prove defective, you and not Brad Moore assume the entire cost of any service and repair. 
\par 
\par BRAD MOORE IS NOT RESPONSIBLE FOR ANY
 INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES OF ANY CHARACTER INCLUDING, WITHOUT LIMITATION, DAMAGES FOR LOSS OF GOODWILL, WORK STOPPAGE, COMPUTER FAILURE OR MALFUNCTION, OR ANY AND ALL OTHER COMMERCIAL DAMAGES OR LOSSES. 
\par 
\par Title, ownership rights and intellectual property rights in and to the Software shall remain with Brad Moore. The Software is protected by international copyright treaties.}{\cgrid0 
\par }{
\par }}